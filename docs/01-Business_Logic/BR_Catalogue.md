# Business Rules Catalogue - ููุฑุณ ููุงุนุฏ ุงูุนูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูููู ูู **ุงููุฑุฌุน ุงูุฑุฆูุณู** ูุฌููุน ููุงุนุฏ ุงูุนูู ูู ุงููุธุงู.
ูู ูุงุนุฏุฉ ููุง ุฑูู ูุฑูุฏ (BR-XXX) ููุณุชุฎุฏู ูู ุงูููุฏ ูุงูุชูุซูู.

---

## ๐๏ธ ุงูุชุตูููุงุช

| ุงูุฑูุฒ | ุงููุฆุฉ | ุงููุตู |
|-------|-------|-------|
| BR-INV | Invoices | ููุงุนุฏ ุงูููุงุชูุฑ |
| BR-COL | Collections | ููุงุนุฏ ุงูุชุญุตููุงุช |
| BR-SHP | Shipments | ููุงุนุฏ ุงูุดุญูุงุช |
| BR-INV-FIFO | Inventory FIFO | ููุงุนุฏ ุงููุฎุฒูู |
| BR-CUS | Customers | ููุงุนุฏ ุงูุนููุงุก |
| BR-SUP | Suppliers | ููุงุนุฏ ุงูููุฑุฏูู |
| BR-ACC | Accounts | ููุงุนุฏ ุงูุฎุฒูุฉ ูุงูุจูู |
| BR-RPT | Reports | ููุงุนุฏ ุงูุชูุงุฑูุฑ |
| BR-SEC | Security | ููุงุนุฏ ุงูุฃูุงู |
| BR-VAL | Validation | ููุงุนุฏ ุงูุชุญูู |

---

## ๐ ุงูููุงุชูุฑ (BR-INV)

### BR-INV-001: ุฅูุดุงุก ูุงุชูุฑุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุนูุฏ ุฅูุดุงุก ูุงุชูุฑุฉุ ูุชู ุชุญุฏูุซ ุฑุตูุฏ ุงูุนููู ุชููุงุฆูุงู |
| **ุงููุงุนุฏุฉ** | `customer.balance += invoice.total` |
| **ุงูููุญูุฒ** | InvoiceObserver::created |
| **ุงูุดุฑูุท** | ุงููุงุชูุฑุฉ status = 'active' |

### BR-INV-002: ุฑุตูุฏ ุงููุงุชูุฑุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฑุตูุฏ ุงููุงุชูุฑุฉ = ุงูุฅุฌูุงูู - ุงููุฏููุน |
| **ุงููุงุนุฏุฉ** | `invoice.balance = invoice.total - invoice.paid_amount` |
| **ุงูุชุญุฏูุซ** | ุนูุฏ ุงูุฅูุดุงุก ูุนูุฏ ูู ุชุญุตูู |
| **Index** | ูุนูุ ููุจุญุซ ุงูุณุฑูุน ุนู ุงูููุงุชูุฑ ุบูุฑ ุงููุณุฏุฏุฉ |

### BR-INV-003: ุฅูุบุงุก ูุงุชูุฑุฉ โ๏ธ (ูุงุนุฏุฉ ุญุฑุฌุฉ)
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุนูุฏ ุฅูุบุงุก ูุงุชูุฑุฉุ ูุฌุจ ุงูุชุนุงูู ูุน Allocations ุฃููุงู |
| **ุงูุฎุทูุงุช** | 1๏ธโฃ ูู ุงุฑุชุจุงุท ุงูู Allocations (ุฅุฑุฌุงุน ุงููุจุงูุบ ููุชุญุตููุงุช) |
|            | 2๏ธโฃ ุชูููู ุฑุตูุฏ ุงูุนููู ุจุงููุจูุบ **ุงูุฅุฌูุงูู** |
|            | 3๏ธโฃ ุชุตููุฑ balance ู paid_amount |
| **ุงููุงุนุฏุฉ** | `customer.balance -= invoice.total` |
| **ุงูููุญูุฒ** | InvoiceObserver::updated (status โ cancelled) |
| **ุงูุชูููุฐ** | `CollectionService::reverseAllocationsForInvoice($invoice)` |

> โ๏ธ **ููุงุฐุง ุงูุฅุฌูุงูู ูููุณ ุงูุฑุตูุฏุ**
> ูุฃููุง ุณููุบู ุงูู allocationsุ ูุจุงูุชุงูู ุงููุจุงูุบ ุงููุฏููุนุฉ ุณุชุนูุฏ ูุฑุตูุฏ ุฏุงุฆู ููุนููู.
> ุงููุนุงุฏูุฉ: `customer.balance -= total` ุซู `allocations.delete` ุณูุฒูุฏ ุงูุฑุตูุฏ ุจู `paid_amount`
> ุงููุชูุฌุฉ: `balance = original - total + paid = original - (total - paid) = original - balance` โ

### BR-INV-003b: ูู ุงูุงุฑุชุจุงุทุงุช ุนูุฏ ุงูุฅูุบุงุก
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุญุฐู allocations ุงููุฑุชุจุทุฉ ุจูุงุชูุฑุฉ ููุบุงุฉ |
| **ุงููุงุนุฏุฉ** | `invoice.allocations.each.delete()` |
| **ุงูุณุจุจ** | ููุน ุชูุงูุถ: ูุงุชูุฑุฉ ููุบุงุฉ + allocations ูุดุทุฉ |
| **ุงูุฃุซุฑ** | ุงูุชุญุตูู ูุตุจุญ ุบูุฑ ููุฒุน (ุฑุตูุฏ ุฏุงุฆู ููุนููู) |

### BR-INV-004: ููุน ุญุฐู ุงูููุงุชูุฑ ููุงุฆูุงู โ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุญุฐู ููููุน ุชูุงูุงู - ุงุณุชุฎุฏู ุงูุฅูุบุงุก |
| **ุงููุงุนุฏุฉ** | `throw Exception("ูุง ูููู ุญุฐู ุงูููุงุชูุฑ")` |
| **ุงูููุญูุฒ** | InvoiceObserver::deleting |
| **ุงูุณุจุจ** | ุงูุฅูุบุงุก ูุญุงูุธ ุนูู ุณุฌู ุงููุฑุงุฌุนุฉ |
| **Error Code** | `INV_001` |

### BR-INV-005: ูุญุต ุณูุงูุฉ ุงูุชุนุฏูู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูุง ูููู ุชูููู ูููุฉ ุงููุงุชูุฑุฉ ูุชุตุจุญ ุฃูู ูู ุงููุฏููุน |
| **ุงููุงุนุฏุฉ** | `if (new_total < paid_amount) throw Exception` |
| **ุงูููุญูุฒ** | InvoiceObserver::updated |
| **ุงูุฑุณุงูุฉ** | "ูุง ูููู ุชูููู ูููุฉ ุงููุงุชูุฑุฉ ุฃูู ูู ุงููุจูุบ ุงููุฏููุน" |

### BR-INV-006: ูุงูุฐุฉ ุงูุชุนุฏูู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุชุนุฏูู ูุณููุญ ููุท ูู ุงูููู ุงูุญุงูู + ุงูุฃูุงู ุงููุญุฏุฏุฉ |
| **ุงููุงุนุฏุฉ** | `invoice.date >= now() - settings.edit_window_days` |
| **ุงูููุญูุฒ** | InvoicePolicy::update |
| **ุงูุฅุนุฏุงุฏ** | `settings.edit_window_days` (ุงูุชุฑุงุถู: 1) |

### BR-INV-007: ุชูููุฏ ุฑูู ุงููุงุชูุฑุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฑูู ูุฑูุฏ ูุชุจุน ุงูุตูุบุฉ ุงููุญุฏุฏุฉ ูู ุงูุฅุนุฏุงุฏุงุช |
| **ุงููุงุนุฏุฉ** | `{prefix}-{year}{month}-{sequence}` |
| **ุงูููุญูุฒ** | InvoiceNumberGenerator::generate |
| **ุงูุฅุนุฏุงุฏุงุช** | prefix, format, sequence_length, reset_monthly |

---

## ๐ ุงูุชุญุตููุงุช (BR-COL)

### BR-COL-001: ุฅูุดุงุก ุชุญุตูู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุนูุฏ ุฅูุดุงุก ุชุญุตููุ ูุชู ุชูููู ุฑุตูุฏ ุงูุนููู |
| **ุงููุงุนุฏุฉ** | `customer.balance -= collection.amount` |
| **ุงูููุญูุฒ** | CollectionObserver::created |
| **ุงููุชูุฌุฉ** | ุฑุตูุฏ ุณุงูุจ = ุฑุตูุฏ ุฏุงุฆู ููุนููู |

### BR-COL-002: ุชูุฒูุน FIFO
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุชูุฒูุน ูุจูุบ ุงูุชุญุตูู ุนูู ุงูููุงุชูุฑ ุงูุฃูุฏู ุฃููุงู |
| **ุงููุงุนุฏุฉ** | `ORDER BY date ASC WHERE balance > 0` |
| **ุงูููุญูุฒ** | CollectionService::allocatePayment |
| **ุงูุฅุนุฏุงุฏ** | `settings.collection_distribution` |

### BR-COL-003: ุชุณุฌูู ุงูุชูุฒูุน
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูู ุชูุฒูุน ููุณุฌู ูู collection_allocations |
| **ุงููุงุนุฏุฉ** | ุณุฌู ููู ูุงุชูุฑุฉ ุชู ุงูุณุฏุงุฏ ูููุง |
| **ุงูุญููู** | collection_id, invoice_id, amount |

### BR-COL-004: ุชุญุฏูุซ ุงููุงุชูุฑุฉ ุนูุฏ ุงูุชูุฒูุน
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุนูุฏ ุชุฎุตูุต ูุจูุบ ููุงุชูุฑุฉ |
| **ุงููุงุนุฏุฉ** | `invoice.paid_amount += amount; invoice.balance -= amount` |
| **ุงูููุญูุฒ** | CollectionAllocationObserver::created |

### BR-COL-005: Race Condition Protection
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ููุน ุชุนุงุฑุถ ุงูุนูููุงุช ุงููุชุฒุงููุฉ |
| **ุงููุงุนุฏุฉ** | `lockForUpdate()` ุนูู ุงูููุงุชูุฑ |
| **ุงูููุญูุฒ** | CollectionService::allocatePayment |
| **ุงูุณูุงู** | DB::transaction |

### BR-COL-006: ุฅูุบุงุก ุชุญุตูู โ๏ธ (ุชุตุญูุญ 2025-12-13)
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุนูุฏ ุฅูุบุงุก ุชุญุตููุ ูุฌุจ ุงูุชุนุงูู ูุน Allocations ุฃููุงู |
| **ุงูุฎุทูุงุช** | 1๏ธโฃ ูู ุงุฑุชุจุงุท ุงูู Allocations |
|            | 2๏ธโฃ ุฒูุงุฏุฉ ุฑุตูุฏ ุงูุนููู ุจุงููุจูุบ |
| **ุงููุงุนุฏุฉ** | `customer.balance += collection.amount` |
| **ุงูููุญูุฒ** | CollectionObserver::updated (status โ cancelled) |

### BR-COL-007: ููุน ุญุฐู ุงูุชุญุตููุงุช ููุงุฆูุงู โ (ุชุตุญูุญ 2025-12-13)
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุญุฐู ููููุน ุชูุงูุงู - ุงุณุชุฎุฏู ุงูุฅูุบุงุก |
| **ุงููุงุนุฏุฉ** | `throw Exception("ูุง ูููู ุญุฐู ุงูุชุญุตููุงุช")` |
| **ุงูููุญูุฒ** | CollectionObserver::deleting |
| **ุงูุณุจุจ** | ุงูุฅูุบุงุก ูุญุงูุธ ุนูู ุณุฌู ุงููุฑุงุฌุนุฉ |
| **Error Code** | `COL_001` |

---

## ๐ ุงูุดุญูุงุช (BR-SHP)

### BR-SHP-001: ุญุงูุงุช ุงูุดุญูุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุชุฏูู ุญุงูุงุช ุงูุดุญูุฉ |
| **ุงููุงุนุฏุฉ** | `open โ closed โ settled` |
| **ุนูุณู** | `settled โ closed` (Unsettle) |

### BR-SHP-002: ุฅุบูุงู ุชููุงุฆู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุดุญูุฉ ุชูุบูู ุชููุงุฆูุงู ุนูุฏ ููุงุฏ ุงููููุฉ |
| **ุงููุงุนุฏุฉ** | `if (SUM(remaining_quantity) = 0) status = 'closed'` |
| **ุงูููุญูุฒ** | ShipmentItemObserver::updated |

### BR-SHP-003: ุชุตููุฉ ุงูุดุญูุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุนูุฏ ุงูุชุตููุฉุ ุงููุชุจูู ููุฑุญู ููุดุญูุฉ ุงูุชุงููุฉ |
| **ุงููุงุนุฏุฉ** | ุฅูุดุงุก ุณุฌู Carryover + ShipmentItem ูู ุงูุดุญูุฉ ุงูุฌุฏูุฏุฉ |
| **ุงูููุญูุฒ** | ShipmentController::settle |

### BR-SHP-004: ุฅูุบุงุก ุงูุชุตููุฉ (Unsettle)
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงุณุชุฑุฌุงุน ุงููููุงุช ุงููุฑุญูุฉ ููุดุญูุฉ ุงูุฃุตููุฉ |
| **ุงููุงุนุฏุฉ** | ุนูุณ ุนูููุฉ ุงูุชุฑุญูู |
| **ุงูููุญูุฒ** | ShipmentObserver::updated (settled โ closed) |
| **ุงูุดุฑุท** | ุงููููุฉ ูู ุชูุจุงุน ูู ุงูุดุญูุฉ ุงูุชุงููุฉ |

### BR-SHP-005: ุญูุงูุฉ Unsettle
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ููุน Unsettle ุฅุฐุง ุจูุนุช ุงููููุฉ ุงููุฑุญูุฉ |
| **ุงููุงุนุฏุฉ** | `if (nextItem.remaining < carryover.quantity) throw Exception` |
| **ุงูููุญูุฒ** | ShipmentObserver::reverseCarryovers |
| **ุงูุฑุณุงูุฉ** | "ุงููููุฉ ุงููุฑุญูุฉ ุชู ุจูุนูุง ูู ุงูุดุญูุฉ ุงูุชุงููุฉ" |

### BR-SHP-006: ููุน ุญุฐู ุดุญูุฉ ููุง ููุงุชูุฑ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูุง ูููู ุญุฐู ุดุญูุฉ ูุฑุชุจุทุฉ ุจููุงุชูุฑ |
| **ุงููุงุนุฏุฉ** | ูุญุต invoice_items ุงููุฑุชุจุทุฉ |
| **ุงูููุญูุฒ** | ShipmentObserver::deleting |

### BR-SHP-007: ููุน ุชุนุฏูู ุดุญูุฉ ููุตูุงุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุญููู ุงูุฃุฎุฑู ุบูุฑ status ููููุน ุชุนุฏูููุง |
| **ุงููุงุนุฏุฉ** | ููุท status ู updated_at ูุณููุญ |
| **ุงูููุญูุฒ** | ShipmentObserver::updating |

---

## ๐ ุงููุฎุฒูู FIFO (BR-INV-FIFO)

### BR-FIFO-001: ุชุฎุตูุต ุงููููุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุจูุน ูู ุฃูุฏู ุดุญูุฉ ุฃููุงู |
| **ุงููุงุนุฏุฉ** | `ORDER BY shipment.date ASC WHERE remaining_quantity > 0` |
| **ุงูููุญูุฒ** | FifoAllocatorService::allocateQuantity |

### BR-FIFO-002: ุชุชุจุน ุงููุตุฏุฑ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูู ุจูุฏ ูุงุชูุฑุฉ ูุญุชูุธ ุจูุตุฏุฑ ุงูู FIFO |
| **ุงููุงุนุฏุฉ** | `invoice_items.shipment_item_id` |
| **ุงููุงุฆุฏุฉ** | ุชุชุจุน ุงููุจูุนุงุช ููู ุดุญูุฉ |

### BR-FIFO-003: ุชุญุฏูุซ ุงููุชุจูู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฎุตู ุงููููุฉ ุงููุจุงุนุฉ ูู ุงููุชุจูู |
| **ุงููุงุนุฏุฉ** | `shipment_item.remaining_quantity -= sold_quantity` |
| **ุงูููุญูุฒ** | ุนูุฏ ุฅูุดุงุก invoice_item |

---

## ๐ ุงูุนููุงุก (BR-CUS)

### BR-CUS-001: ููุทู ุงูุฑุตูุฏ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฑุตูุฏ ุงูุนููู ูุนูุณ ุงูุญุงูุฉ ุงููุงููุฉ |
| **ุงููุงุนุฏุฉ** | `+` ูุฏููู / `0` ุฎุงูุต / `-` ุฏุงุฆู |
| **ุงูุชุญุฏูุซ** | ุนุจุฑ Observers ููุท |

### BR-CUS-002: ุฒูุงุฏุฉ ุงูุฑุตูุฏ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุฑุตูุฏ ูุฒูุฏ ุนูุฏ ุฅูุดุงุก ูุงุชูุฑุฉ |
| **ุงููุงุนุฏุฉ** | `balance += invoice.total` |

### BR-CUS-003: ุชูููู ุงูุฑุตูุฏ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุฑุตูุฏ ููู ุนูุฏ ุงูุชุญุตูู ุฃู ุฅูุบุงุก ูุงุชูุฑุฉ |
| **ุงููุงุนุฏุฉ** | `balance -= amount` |

---

## ๐ ุงูููุฑุฏูู (BR-SUP)

### BR-SUP-001: ููุทู ุงูุฑุตูุฏ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฑุตูุฏ ุงูููุฑุฏ ูุนูุณ ุงููุฏููููุฉ |
| **ุงููุงุนุฏุฉ** | `+` ูู ุนูุฏูุง / `0` ุฎุงูุต / `-` ุนูููุง |

---

## ๐ ุงูุฎุฒูุฉ ูุงูุจูู (BR-ACC)

### BR-ACC-001: ุชุญุฏูุซ ุงูุฑุตูุฏ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฑุตูุฏ ุงูุญุณุงุจ ููุญุฏุซ ุนูุฏ ูู ุนูููุฉ |
| **ุงููุงุนุฏุฉ** | `account.balance += transaction.amount` |
| **ุงูููุญูุฒ** | CashboxTransactionObserver / BankTransactionObserver |

### BR-ACC-002: ุงูุชุญููู ุจูู ุงูุญุณุงุจุงุช
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุชุญููู ููุดุฆ ุนูููุชูู ูุชุนุงูุณุชูู |
| **ุงููุงุนุฏุฉ** | ุณุญุจ ูู ุงููุตุฏุฑ + ุฅูุฏุงุน ูู ุงููุฌูุฉ |

---

## ๐ ุงูุชูุงุฑูุฑ (BR-RPT)

### BR-RPT-001: ุงูุชูุฑูุฑ ุงููููู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ููุฎุต ูููู ููู ุงูุนูููุงุช |
| **ุงููุญุชูู** | ุงููุจูุนุงุชุ ุงูุชุญุตููุงุชุ ุงููุตุฑููุงุชุ ุงูุฃุฑุตุฏุฉ |
| **ุงูุชูููุฏ** | ูุฏูู ุฃู ุชููุงุฆู ูู ููุงูุฉ ุงูููู |

### BR-RPT-002: ุชุตููุฉ ุงูุดุญูุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุชูุฑูุฑ ุชูุตููู ููู ุดุญูุฉ |
| **ุงููุญุชูู** | ุงููููุงุชุ ุงููุจูุนุงุชุ ุงููุฑุชุฌุนุงุชุ ุงููุงููุ ุงููุฑุญู |

---

## ๐ ุงูุฃูุงู (BR-SEC)

### BR-SEC-001: ููู ุงูุญุณุงุจ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ููู ุงูุญุณุงุจ ุจุนุฏ ูุญุงููุงุช ูุงุดูุฉ |
| **ุงููุงุนุฏุฉ** | 3 ูุญุงููุงุช ูุงุดูุฉ = ููู |
| **ุงููุชุญ** | Admin ููุท |

### BR-SEC-002: ุชุณุฌูู ุงูุนูููุงุช
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูู ุนูููุฉ ุชูุณุฌู ูู audit_logs |
| **ุงููุญุชูู** | ุงููุณุชุฎุฏูุ ุงูููุนุ ุงููุฏููุ ุงูุฌุฏูุฏุ ุงูููุช |

---

## ๐ ุงูุชุญูู (BR-VAL)

### BR-VAL-001: ูุงูุฐุฉ ุงูุชุนุฏูู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุชุนุฏูู ูุณููุญ ูู ูุงูุฐุฉ ุฒูููุฉ ูุญุฏุฏุฉ |
| **ุงููุงุนุฏุฉ** | ุงูููู + ุงูุฃูุงู ุงููุญุฏุฏุฉ ูู ุงูุฅุนุฏุงุฏุงุช |
| **ููุทุจู ุนูู** | ุงูููุงุชูุฑุ ุงูุชุญุตููุงุชุ ุงููุตุฑููุงุช |

### BR-VAL-002: ุงูุญููู ุงูุฅูุฒุงููุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุชุญูู ูู ูุฌูุฏ ุงูุญููู ุงูุฅูุฒุงููุฉ |
| **ุงูููุญูุฒ** | FormRequest ูู Laravel |

---

## ๐ ุงููุฑุชุฌุนุงุช (BR-RET)

### BR-RET-001: ุฅูุดุงุก ูุฑุชุฌุน
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงููุฑุชุฌุน ูููุดุฆ ุณุฌู ุฌุฏูุฏ (ูุง ููุนุฏู ุงููุงุชูุฑุฉ) |
| **ุงูุชุฃุซูุฑ** | 1๏ธโฃ ุฒูุงุฏุฉ ุงููุฎุฒูู 2๏ธโฃ ุชูููู ุฑุตูุฏ ุงูุนููู |
| **ุงูููุญูุฒ** | ReturnObserver::created |

### BR-RET-002: Late Return
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูุฑุชุฌุน ูู ุดุญูุฉ ููุตูุงุฉ |
| **ุงููุงุนุฏุฉ** | ุชุฑุญู ุงูุจุถุงุนุฉ ููุดุญูุฉ ุงูููุชูุญุฉ ุงูุญุงููุฉ |
| **ุงูููุญูุฒ** | ReturnService::processLateReturn |

### BR-RET-003: ุชุญุฏูุซ ุงููุฎุฒูู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฒูุงุฏุฉ remaining_quantity ูู ุงูุดุญูุฉ |
| **ุงููุงุนุฏุฉ** | `shipment_item.remaining_quantity += return.quantity` |
| **ุงูููุญูุฒ** | ReturnObserver::created |

### BR-RET-004: ุชุญุฏูุซ ุฑุตูุฏ ุงูุนููู
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุชูููู ูุง ุนูู ุงูุนููู |
| **ุงููุงุนุฏุฉ** | `customer.balance -= return.total_amount` |
| **ุงูููุญูุฒ** | ReturnObserver::created |

---

## ๐ ุงูุชูุงุฑูุฑ ุงูููููุฉ (BR-DAY)

### BR-DAY-001: ูุชุญ ุฌูุณุฉ ุนูู ููููุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูุฌุจ ูุชุญ ููููุฉ ูุจู ุฃู ุนูููุฉ |
| **ุงููุงุนุฏุฉ** | ุงููุณุชุฎุฏู ูุฎุชุงุฑ ุงูุชุงุฑูุฎ โ ููุญูุธ ูู Session |
| **Opening Balance** | ุขุฎุฑ Closing Balance |
| **API** | `POST /api/daily/open` |

### BR-DAY-002: ุงูุนูููุงุช ุชุฃุฎุฐ ุชุงุฑูุฎ ุงูุฌูุณุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูู ุงูุนูููุงุช ุชุฃุฎุฐ ุชุงุฑูุฎ ุงูููููุฉ ุงูููุชูุญุฉ ุชููุงุฆูุงู |
| **ุงููุงุนุฏุฉ** | `operation.date = session('working_date')` |
| **ุจุฏูู** | ูุง ุญุงุฌุฉ ูุฅุฏุฎุงู ุงูุชุงุฑูุฎ ูู ูู ุนูููุฉ |

### BR-DAY-003: ุงูุชูุงุฑูุฎ ุงููุชุงุญุฉ ูููุชุญ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุชุญุฏูุฏ ุฃู ุชุงุฑูุฎ ูููู ูุชุญู |
| **ุงููุทุงู** | `today - backdated_days` ุฅูู `today` |
| **ุงูุงุณุชุจุนุงุฏ** | ุงูุชูุงุฑูุฎ ุงููุบููุฉ (status = 'closed') |
| **Setting** | `backdated_days` (default: 2) |

### BR-DAY-004: ููุน ุงูุนูู ุจุฏูู ููููุฉ ููุชูุญุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูุง ูููู ุฅูุดุงุก ูุงุชูุฑุฉ/ุชุญุตูู ุจุฏูู ูุชุญ ููููุฉ |
| **ุงููุงุนุฏุฉ** | `if (!session('working_date')) throw` |
| **Middleware** | `EnsureWorkingDay` |

### BR-DAY-005: ุฅุบูุงู ุงูููููุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฅุบูุงู ุงูููููุฉ ูุฏููุงู ููุงูุฉ ุงูุนูู |
| **ุงูุตูุงุญูุฉ** | `daily.close` |
| **ุงูุฃุซุฑ** | ุญุณุงุจ ุงูุฅุฌูุงููุงุช + Closing Balance + status = 'closed' |

### BR-DAY-006: ุฅุนุงุฏุฉ ูุชุญ ููููุฉ ูุบููุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุฅุนุงุฏุฉ ูุชุญ ููู ูุบูู ููุชุตุญูุญุงุช |
| **ุงูุตูุงุญูุฉ** | `daily.reopen` |
| **ุงูุงุณุชุฎุฏุงู** | ุงุณุชุซูุงุฆู ููุชุตุญูุญุงุช ููุท |

---

## ๐ Reports (ุงูุชูุงุฑูุฑ)

### BR-RPT-001: ุชูุฑูุฑ ุฅุบูุงู ุงูููููุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูููุดุฃ ุชููุงุฆูุงู ุนูุฏ ุฅุบูุงู ุงูููููุฉ |
| **ุงููุญุชูู** | ููุงุชูุฑ + ุชุญุตููุงุช + ูุตุฑููุงุช + ุชุญูููุงุช + ุฃุฑุตุฏุฉ |
| **ุงูุชูุณูู** | PDF |

### BR-RPT-002: ุชูุฑูุฑ ุชุตููุฉ ุงูุดุญูุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ูููุดุฃ ุนูุฏ ุชุตููุฉ ุงูุดุญูุฉ |
| **ุงููุญุชูู** | ูุจูุนุงุช + ูุฑุชุฌุนุงุช + ูุฎุฒูู + ุญุณุงุจ ุงูููุฑุฏ |
| **ุงูุชูุณูู** | PDF |

### BR-RPT-003: ุญุณุงุจ ุนูููุฉ ุงูุดุฑูุฉ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุงูุนูููุฉ ุชูุญุณุจ ุนูู ุตุงูู ุงููุจูุนุงุช |
| **ุงููุงุนุฏุฉ** | `ุตุงูู ุงููุจูุนุงุช = ุฅุฌูุงูู ุงููุจูุนุงุช - ูุฑุชุฌุนุงุช ุงูุดุญูุฉ ุงูุณุงุจูุฉ` |
| **ุงูุญุณุงุจ** | `ุงูุนูููุฉ = ุตุงูู ุงููุจูุนุงุช ร company_commission_rate%` |
| **Setting** | `company_commission_rate` (default: 6) |

### BR-RPT-004: ุฏูุนุงุช ุงูููุฑุฏ
| ุงูุญูู | ุงููููุฉ |
|-------|--------|
| **ุงููุตู** | ุชูุณุฌู ููุตุฑูู ูู ููุน ุฎุงุต |
| **ุงูููุน** | `expenses.type = 'supplier_payment'` |
| **ุงูุฃุซุฑ** | ุชูุฎุตู ูู ุฑุตูุฏ ุงูููุฑุฏ ูู ุงูุชุตููุฉ |

---

## ๐ ุฅุญุตุงุฆูุงุช

| ุงููุฆุฉ | ุนุฏุฏ ุงูููุงุนุฏ |
|-------|-------------|
| Invoices | 7 |
| Collections | 5 |
| Shipments | 7 |
| FIFO | 3 |
| Customers | 3 |
| Suppliers | 1 |
| Accounts | 2 |
| Security | 2 |
| Validation | 2 |
| Returns | 4 |
| **Daily Reports** | **6** |
| **Reports** | **4** |
| **ุงูุฅุฌูุงูู** | **46** |

---

## ๐ ุงููููุงุช ุงููุฑุชุจุทุฉ

- [BL_Invoices.md](BL_Invoices.md) - ููุทู ุงูููุงุชูุฑ
- [BL_Collections.md](BL_Collections.md) - ููุทู ุงูุชุญุตููุงุช
- [BL_Shipments.md](BL_Shipments.md) - ููุทู ุงูุดุญูุงุช
- [BL_Refunds.md](BL_Refunds.md) - ููุทู ุงููุฑุชุฌุนุงุช
- [BL_DailyReports.md](BL_DailyReports.md) - ููุทู ุงูุชูุงุฑูุฑ ุงูููููุฉ
- [BL_Users.md](BL_Users.md) - ููุทู ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
- [BL_Corrections.md](BL_Corrections.md) - ููุทู ุงูุชุตุญูุญุงุช
